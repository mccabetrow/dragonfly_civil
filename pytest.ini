[pytest]
addopts = -q --strict-markers -m "not legacy and not integration and not integration_infra and not integration_schema and not performance and not security and not contract"
pythonpath = .
testpaths = tests
asyncio_mode = auto
timeout = 10
timeout_method = thread
markers =
	integration: marks tests as integration tests - requires live DB (deselect with '-m "not integration"')
	integration_infra: marks infrastructure availability tests - connectivity, PostgREST, Realtime (run with '-m integration_infra')
	integration_schema: marks schema correctness tests - table existence, RPC logic, business flows (run with '-m integration_schema')
	slow: marks tests that take >1 second (deselect with '-m "not slow"')
	e2e: marks end-to-end tests that test full workflow (deselect with '-m "not e2e"')
	unit: marks unit tests that don't require external dependencies
	legacy: marks legacy tests pending modernization (explicitly run with '-m legacy')
	performance: marks performance budget tests - require live DB with EXPLAIN ANALYZE (run with '-m performance')
	security: marks security invariant tests - require live DB for RLS/SECDEF audits (run with '-m security')
	contract: marks RPC/schema contract tests - require live DB for signature validation (run with '-m contract')
	audit: marks audit logging tests - require ops.audit_log table (run with '-m audit')
filterwarnings =
	ignore::DeprecationWarning
	ignore::PendingDeprecationWarning
